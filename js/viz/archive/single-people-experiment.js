var VIZ=function(e){return e.singlePeople=function(){function e(e,n,t){var r={connectCountyIds:function(e){for(var n,t=0,r=e.singlesData.length,a={};r>t;t++)n=e.singlesData[t],a={total:n.total,percentMen:n.percentMen,percentWomen:n.percentWomen},s.set(+e.singlesData[t].id,a)},buildScales:function(){return{linear:function(e){return d3.scale.linear().clamp(!0).domain([50,60]).range([e[0],e[1]])},featureFill:function(e){var n=[],t={men:{r:this.linear([247,8]),g:this.linear([251,48]),b:this.linear([255,107])},women:{r:this.linear([255,103]),g:this.linear([245,0]),b:this.linear([240,13])}};return"undefined"==typeof e?!1:n=e.percentMen>e.percentWomen?[t.men.r(e.percentMen),t.men.g(e.percentMen),t.men.b(e.percentMen)]:[t.women.r(e.percentWomen),t.women.g(e.percentWomen),t.women.b(e.percentWomen)]}}},reset:function(e,t,r){var a=e.bounds(topojson.feature(n,n.objects.counties)),s=a[0],l=a[1];o.attr("width",l[0]-s[0]).attr("height",l[1]-s[1]).style("left",s[0]+"px").style("top",s[1]+"px"),i.attr("transform","translate("+-s[0]+","+-s[1]+")"),t.attr("d",e),r.attr("d",e)},projectPoint:function(e,n){var t=a.latLngToLayerPoint(new L.LatLng(n,e));this.stream.point(t.x,t.y)},init:function(){var e,r,o,l,c,p=this;p.connectCountyIds(t),e=d3.geo.transform({point:p.projectPoint}),r=d3.geo.path().projection(e),o=p.buildScales(),l=i.selectAll("circle").data(topojson.feature(n,n.objects.counties).features).enter().append("circle").attr("transform",function(e){return"translate("+r.centroid(e)+")"}).attr("r",1.5).attr("fill",function(e){var n=o.featureFill(s.get(e.id));return n?"rgb("+Math.round(n[0])+","+Math.round(n[1])+","+Math.round(n[2])+")":"white"}),c=i.append("path").datum(topojson.mesh(n,n.objects.states,function(e,n){return e!==n})).attr("class","states"),a.on("viewreset",function(){p.reset(r,l,c)}),p.reset(r,l,c)}};return e?console.warn(e):(r.init(),void 0)}var n=d3.select("#singlePeople"),t=parseInt(n.style("width")),r=.6*t,a=function(){return n.style("height",r+"px"),new L.Map("singlePeople",{center:[37.545,-97.383],zoom:4}).addLayer(new L.TileLayer("http://{s}.tiles.mapbox.com/v3/lukewhyte.iho02bc8/{z}/{x}/{y}.png"))}(),o=d3.select(a.getPanes().overlayPane).append("svg"),i=o.append("g").attr("class","leaflet-zoom-hide"),s=d3.map();queue().defer(d3.json,"../data/single-percentage/us.json").defer(d3.json,"../data/single-percentage/singles.json").await(e)},e}(VIZ||{}),VIZ=function(e){return e.singlePeople=function(){function e(e,n,t){var r={connectCountyIds:function(e){for(var n,t=0,r=e.singlesData.length,a={};r>t;t++)n=e.singlesData[t],a={total:n.total,percentMen:n.percentMen,percentWomen:n.percentWomen},l.set(+e.singlesData[t].id,a)},buildScales:function(){return{linear:function(e){return d3.scale.linear().clamp(!0).domain([50,60]).range([e[0],e[1]])},featureFill:function(e){var n=[],t={men:{r:this.linear([247,8]),g:this.linear([251,48]),b:this.linear([255,107])},women:{r:this.linear([255,103]),g:this.linear([245,0]),b:this.linear([240,13])}};return"undefined"==typeof e?!1:n=e.percentMen>e.percentWomen?[t.men.r(e.percentMen),t.men.g(e.percentMen),t.men.b(e.percentMen)]:[t.women.r(e.percentWomen),t.women.g(e.percentWomen),t.women.b(e.percentWomen)]}}},reset:function(e,n,t){n.attr("d",e),t.attr("d",e)},init:function(){var e,r,a,i=this;i.connectCountyIds(t),e=i.buildScales(),r=s.selectAll("path").data(topojson.feature(n,n.objects.counties).features).enter().append("path").attr("fill",function(n){var t=e.featureFill(l.get(n.id));return t?"rgb("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+")":"white"}),a=s.append("path").datum(topojson.mesh(n,n.objects.states,function(e,n){return e!==n})).attr("class","states"),i.reset(o,r,a)}};return e?console.warn(e):(r.init(),void 0)}var n=d3.select("#singlePeople"),t=parseInt(n.style("width")),r=.625*t,a=d3.geo.albersUsa().scale(1280).translate([t/2,r/2]),o=d3.geo.path().projection(a),i=n.append("svg").attr("width",t).attr("height",r),s=i.append("g").attr("class","counties"),l=d3.map();queue().defer(d3.json,"../data/single-percentage/us.json").defer(d3.json,"../data/single-percentage/singles.json").await(e)},e}(VIZ||{}),VIZ=function(e){return e.singlePeople=function(){function e(e,n){var t={connectCountyIds:function(e){for(var n,t=0,r=e.singlesData.length,a={};r>t;t++)n=e.singlesData[t],a={total:n.total,percentMen:n.percentMen,percentWomen:n.percentWomen},dataById.set(+e.singlesData[t].id,a)},buildScales:function(){return{linear:function(e){return d3.scale.linear().clamp(!0).domain([50,60]).range([e[0],e[1]])},featureFill:function(e){var n=[],t={men:{r:this.linear([247,8]),g:this.linear([251,48]),b:this.linear([255,107])},women:{r:this.linear([255,103]),g:this.linear([245,0]),b:this.linear([240,13])}};return"undefined"==typeof e?!1:n=e.percentMen>e.percentWomen?[t.men.r(e.percentMen),t.men.g(e.percentMen),t.men.b(e.percentMen)]:[t.women.r(e.percentWomen),t.women.g(e.percentWomen),t.women.b(e.percentWomen)]}}},reset:function(e,n){n.attr("d",e)},init:function(){var e;e=g.selectAll("path").data(topojson.feature(n,n.objects["sf-geo"]).features).enter().append("path"),e.attr("d",path)}};return e?console.warn(e):(t.init(),void 0)}var n=d3.select("#singlePeople"),t=parseInt(n.style("width")),r=.625*t,a=d3.geo.albers().scale(1e5).translate([35650,3600]);path=d3.geo.path().projection(a),svg=n.append("svg"),g=svg.append("g").attr("class","counties").attr({width:t,height:r}),dataById=d3.map(),queue().defer(d3.json,"../data/single-percentage/sf.json").defer(d3.json,"../data/single-percentage/singles.json").await(e)},e}(VIZ||{});